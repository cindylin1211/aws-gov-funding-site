# 資料管理工具規劃

## 概述

資料管理工具是一個獨立的管理介面，讓系統管理員可以輕鬆地新增、編輯、刪除和批次匯入補助計畫資料，無需手動編輯 JSON 檔案。

## 主要功能

### 1. CRUD 操作
- **新增補助計畫**: 透過表單介面輸入所有必要資訊
- **編輯補助計畫**: 修改現有補助計畫的任何欄位
- **刪除補助計畫**: 安全地移除補助計畫（含確認對話框）
- **查看列表**: 以表格形式顯示所有補助計畫

### 2. 批次匯入
- **CSV 匯入**: 支援從 CSV 檔案批次匯入資料
- **Excel 匯入**: 支援從 Excel 檔案批次匯入資料
- **範本下載**: 提供標準格式的範本檔案
- **匯入預覽**: 在確認前預覽將要匯入的資料
- **錯誤報告**: 顯示詳細的驗證錯誤和匯入結果

### 3. 資料驗證
- **必填欄位檢查**: 確保所有必要資訊都已填寫
- **格式驗證**: 驗證 URL、日期、金額等格式
- **分類對應**: 檢查主分類和子分類的對應關係
- **即時回饋**: 在輸入時提供即時驗證回饋

### 4. 資料匯出
- **JSON 匯出**: 匯出完整的資料庫為 JSON 格式
- **CSV 匯出**: 匯出為 CSV 格式供 Excel 使用
- **Excel 匯出**: 匯出為 Excel 格式

## 技術架構

### 前端組件
```
src/
├── pages/
│   └── Admin.tsx                 # 管理主頁面
├── components/
│   └── admin/
│       ├── GrantForm.tsx         # 補助計畫表單
│       ├── GrantList.tsx         # 補助計畫列表
│       └── ImportDialog.tsx      # 匯入對話框
├── hooks/
│   └── useDataManagement.ts      # 資料管理 Hook
└── utils/
    ├── dataValidator.ts          # 資料驗證工具
    ├── fileParser.ts             # 檔案解析工具
    └── dataExporter.ts           # 資料匯出工具
```

### 資料流程
```
1. 使用者操作 → Admin Page
2. Admin Page → useDataManagement Hook
3. Hook → Validator (驗證)
4. Hook → Update JSON File
5. Hook → Recalculate Stats
6. Hook → Notify Components
7. Components → Re-render with new data
```

## 使用流程

### 新增補助計畫
1. 點擊「新增補助計畫」按鈕
2. 填寫表單中的所有欄位
3. 系統即時驗證輸入
4. 點擊「儲存」
5. 系統驗證完整性
6. 儲存到 JSON 檔案
7. 更新分類統計
8. 顯示成功訊息

### 編輯補助計畫
1. 在列表中點擊「編輯」按鈕
2. 表單預填現有資料
3. 修改需要變更的欄位
4. 點擊「儲存」
5. 系統驗證並更新資料

### 批次匯入
1. 點擊「匯入」按鈕
2. 下載範本檔案（可選）
3. 上傳填好的 CSV/Excel 檔案
4. 系統解析並驗證資料
5. 顯示匯入預覽
6. 確認匯入
7. 顯示匯入結果報告

## 資料驗證規則

### 必填欄位
- 計畫名稱
- 補助類別
- 子分類
- 補助重點
- 補助對象
- 補助金額
- 補助比例上限
- 計畫時程
- 主辦單位
- 企業規模
- 金額分類
- 主辦機關分類

### 格式驗證
- **URL**: 必須是有效的 HTTP/HTTPS URL
- **日期**: 支援多種日期格式
- **金額**: 支援「最高XXX萬元」或「無上限」格式
- **比例**: 支援「XX%」或「XX%~XX%」格式

### 分類對應
- 主分類必須是：數位轉型、創新研發、人才培訓
- 子分類必須對應正確的主分類
- 企業規模必須是：微型企業、中小企業、大型企業、新創企業
- 金額分類必須是：小額補助、中額補助、大額補助、超大額補助、無上限補助

## 安全性考量

### 資料保護
- 在儲存前進行完整驗證
- 防止 XSS 攻擊（清理輸入）
- 防止 SQL 注入（雖然使用 JSON，但仍需注意）

### 操作確認
- 刪除操作需要二次確認
- 批次匯入前顯示預覽
- 重要操作顯示警告訊息

### 備份建議
- 定期備份 grants-database.json
- 在重大變更前手動備份
- 考慮實作版本控制（未來功能）

## 實作優先順序

### Phase 1: 核心功能（優先）
1. 資料驗證工具
2. 資料管理 Hook
3. 補助計畫表單
4. 補助計畫列表
5. 管理頁面

### Phase 2: 進階功能
6. 檔案解析工具
7. 匯入對話框
8. 資料匯出工具

### Phase 3: 優化功能（可選）
9. 資料版本控制
10. 操作歷史記錄
11. 多使用者權限管理

## 相關文件

- [Requirements Document](./requirements.md) - 查看 Requirement 10, 11, 12
- [Design Document](./design.md) - 查看 Data Management Components
- [Tasks Document](./tasks.md) - 查看任務 1.1 - 1.10

## 開始實作

要開始實作資料管理工具，請按照 tasks.md 中的任務順序執行：

1. 先建立基礎工具（Validator, Parser, Exporter）
2. 再建立 Hook 和組件
3. 最後整合到主應用程式

每個任務都有詳細的實作步驟和需求參考。
